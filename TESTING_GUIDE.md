# 프론트엔드-백엔드 연동 테스트 가이드

## ✅ 완료된 작업
- Vercel 환경 변수 설정 완료
- 재배포 완료
- API 주소: `http://15.134.130.219:3000/api`

## 🧪 테스트 체크리스트

### 1. 백엔드 서버 상태 확인

EC2 터미널에서 다음 명령어 실행:

```bash
# 서버 상태 확인
pm2 status

# 서버 로그 확인
pm2 logs driver-backend --lines 50

# 서버가 정상 실행 중이면 다음 메시지가 보여야 함:
# 서버가 포트 3000에서 실행 중입니다.
```

### 2. API 헬스 체크

브라우저에서 직접 접속하여 테스트:

```
http://15.134.130.219:3000/api/health
```

**예상 응답:**
```json
{
  "status": "OK",
  "message": "서버가 정상적으로 작동 중입니다"
}
```

### 3. 프론트엔드 앱 테스트

#### 3-1. 회원가입 테스트
1. Vercel 배포된 앱 접속
2. 회원가입 페이지로 이동
3. 새 계정 생성 시도
4. **브라우저 개발자 도구 → Network 탭** 확인:
   - `POST http://15.134.130.219:3000/api/auth/signup` 요청 확인
   - 응답 상태 코드: `200` 또는 `201`
   - 응답에 `token` 포함 확인

#### 3-2. 로그인 테스트
1. 생성한 계정으로 로그인
2. **Network 탭** 확인:
   - `POST http://15.134.130.219:3000/api/auth/login` 요청 확인
   - 응답 상태 코드: `200`
3. **Application 탭 → Local Storage** 확인:
   - `authToken` 키에 JWT 토큰 저장 확인

#### 3-3. 주행 기록 테스트
1. 로그인 후 주행 시작
2. 주행 종료
3. **Network 탭** 확인:
   - `POST http://15.134.130.219:3000/api/driving-logs` 요청 확인
   - 주행 기록이 저장되는지 확인

#### 3-4. 쿠폰 테스트
1. 우리동네 페이지에서 챌린지 완료
2. 쿠폰 발급 버튼 클릭
3. **Network 탭** 확인:
   - `POST http://15.134.130.219:3000/api/coupons/issue` 요청 확인
   - `GET http://15.134.130.219:3000/api/coupons` 요청 확인

#### 3-5. 챌린지 정보 테스트
1. 우리동네 페이지 접속
2. **Network 탭** 확인:
   - `GET http://15.134.130.219:3000/api/challenges` 요청 확인
   - 챌린지 정보가 표시되는지 확인

## 🔍 디버깅 방법

### 브라우저 개발자 도구

#### Network 탭
- 모든 API 요청 확인
- 요청 URL, 메서드, 상태 코드 확인
- 요청/응답 본문 확인

#### Console 탭
- JavaScript 오류 확인
- API 오류 메시지 확인

#### Application 탭
- Local Storage → `authToken` 확인
- 토큰이 저장되어 있는지 확인

### 백엔드 로그 확인

EC2 터미널에서:

```bash
# 실시간 로그 확인
pm2 logs driver-backend --lines 100

# 특정 시간 이후 로그만 확인
pm2 logs driver-backend --lines 200 --nostream | tail -100
```

## ⚠️ 일반적인 문제와 해결 방법

### 1. CORS 오류
**증상:** 브라우저 콘솔에 CORS 관련 오류 메시지

**해결:**
- 백엔드 `server.js`에서 `app.use(cors())` 확인
- 필요 시 특정 도메인만 허용하도록 수정

### 2. 연결 실패 (Failed to fetch)
**증상:** Network 탭에서 요청이 실패

**해결:**
1. EC2 서버가 실행 중인지 확인: `pm2 status`
2. Security Group에서 포트 3000이 열려있는지 확인
3. EC2 인스턴스의 Public IP가 올바른지 확인

### 3. 401 Unauthorized 오류
**증상:** 인증이 필요한 API에서 401 오류

**해결:**
1. 로그인이 제대로 되었는지 확인
2. Local Storage에 `authToken`이 있는지 확인
3. 토큰이 만료되지 않았는지 확인

### 4. 404 Not Found 오류
**증상:** API 엔드포인트를 찾을 수 없음

**해결:**
1. API 경로가 올바른지 확인 (`/api/...`)
2. 백엔드 라우트가 제대로 등록되었는지 확인

### 5. 500 Internal Server Error
**증상:** 서버 내부 오류

**해결:**
1. EC2에서 서버 로그 확인: `pm2 logs driver-backend`
2. 데이터베이스 연결 확인
3. 환경 변수 설정 확인

## 📊 성공 기준

다음 항목이 모두 정상 작동하면 연동 성공:

- ✅ 회원가입 시 API 요청 성공
- ✅ 로그인 시 토큰 저장 및 API 요청 성공
- ✅ 주행 기록 저장 시 API 요청 성공
- ✅ 쿠폰 목록 조회 시 API 요청 성공
- ✅ 챌린지 정보 조회 시 API 요청 성공
- ✅ 브라우저 콘솔에 오류 없음
- ✅ Network 탭에서 모든 API 요청이 성공 (200, 201 상태 코드)

## 🎉 다음 단계

연동이 성공적으로 완료되면:

1. **사용자 테스트**
   - 실제 사용 시나리오 테스트
   - 다양한 데이터 입력 테스트

2. **성능 최적화**
   - API 응답 시간 확인
   - 불필요한 요청 최소화

3. **에러 처리 개선**
   - 사용자 친화적인 에러 메시지
   - 네트워크 오류 처리

4. **보안 강화**
   - HTTPS 설정 (선택사항)
   - 토큰 만료 처리
   - 입력 데이터 검증
